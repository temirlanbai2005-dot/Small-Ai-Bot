"""
–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Google Gemini AI
"""

import logging
import google.generativeai as genai
from config.settings import GEMINI_API_KEY

logger = logging.getLogger(__name__)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Gemini
genai.configure(api_key=GEMINI_API_KEY)
model = genai.GenerativeModel('gemini-2.5-flash')

async def ask_gemini(prompt: str, context: str = None) -> str:
    """
    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∫ Gemini AI
    """
    try:
        full_prompt = prompt
        if context:
            full_prompt = f"{context}\n\n{prompt}"
        
        response = model.generate_content(full_prompt)
        return response.text
    
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ Gemini API: {e}")
        raise

async def generate_art_idea() -> str:
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–¥–µ–∏ –¥–ª—è 3D-–∞—Ä—Ç–∞
    """
    prompt = """
–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∫—Ä–µ–∞—Ç–∏–≤–Ω—É—é –∏ –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–¥–µ—é –¥–ª—è 3D-–∞—Ä—Ç–∞ –∏–ª–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.

–í–∫–ª—é—á–∏:
‚Ä¢ –ö–æ–Ω—Ü–µ–ø—Ç –∏ –æ—Å–Ω–æ–≤–Ω—É—é –∏–¥–µ—é
‚Ä¢ –°—Ç–∏–ª—å (—Ñ–æ—Ç–æ—Ä–µ–∞–ª–∏–∑–º, —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è, low poly –∏ —Ç.–¥.)
‚Ä¢ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É
‚Ä¢ –¶–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É
‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ (–æ—Å–≤–µ—â–µ–Ω–∏–µ, –∫–æ–º–ø–æ–∑–∏—Ü–∏—è)
‚Ä¢ –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã –∏–ª–∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ

–û–ø–∏—à–∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
    """
    
    try:
        response = model.generate_content(prompt)
        return response.text
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–∏: {e}")
        raise

async def generate_motivation() -> str:
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è 3D-–∞—Ä—Ç–∏—Å—Ç–∞
    """
    prompt = """
–°–æ–∑–¥–∞–π –∫–æ—Ä–æ—Ç–∫–æ–µ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è 3D-–∞—Ä—Ç–∏—Å—Ç–∞ –Ω–∞ –¥–µ–Ω—å.
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–º, –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º.
–ú–∞–∫—Å–∏–º—É–º 3-4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
    """
    
    try:
        response = model.generate_content(prompt)
        return response.text
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–æ—Ç–∏–≤–∞—Ü–∏–∏: {e}")
        return "–ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç —Ç–µ–±—è –∫ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤—É. –ü—Ä–æ–¥–æ–ª–∂–∞–π —Å–æ–∑–¥–∞–≤–∞—Ç—å! üöÄ"

async def generate_project_idea() -> str:
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–¥–µ–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
    """
    prompt = """
–ü—Ä–µ–¥–ª–æ–∂–∏ –∏–¥–µ—é –¥–ª—è –Ω–µ–±–æ–ª—å—à–æ–≥–æ 3D-–ø—Ä–æ–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞ 1-3 –¥–Ω—è.
–ò–¥–µ—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å:
‚Ä¢ –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π
‚Ä¢ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
‚Ä¢ –ü–æ–ª–µ–∑–Ω–æ–π –¥–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

–û–ø–∏—à–∏ –∫—Ä–∞—Ç–∫–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è).
    """
    
    try:
        response = model.generate_content(prompt)
        return response.text
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–∏ –ø—Ä–æ–µ–∫—Ç–∞: {e}")
        return "–°–æ–∑–¥–∞–π —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ low-poly —Å—Ç–∏–ª–µ —Å —è—Ä–∫–∏–º–∏ —Ü–≤–µ—Ç–∞–º–∏ –∏ –ø—Ä–æ—Å—Ç–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π. –û—Ç–ª–∏—á–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ! üé®"

async def analyze_trends(trends_data: dict) -> str:
    """
    –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    """
    prompt = f"""
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã –≤ 3D-–∞—Ä—Ç–µ –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

–î–∞–Ω–Ω—ã–µ: {trends_data}

–í—ã–¥–µ–ª–∏:
‚Ä¢ –ì–ª–∞–≤–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏
‚Ä¢ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∞—Ä—Ç–∏—Å—Ç–æ–≤

–û—Ç–≤–µ—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.
    """
    
    try:
        response = model.generate_content(prompt)
        return response.text
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–Ω–¥–æ–≤: {e}")
        return "–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω."
